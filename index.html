<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Settings</title>
    <style>
        body {
            background-color: var(--tg-theme-bg-color, #212121);
            color: var(--tg-theme-text-color, #ffffff);
            font-family: sans-serif;
            padding: 20px;
        }
        .container { display: flex; flex-direction: column; gap: 15px; }
        label { font-size: 14px; color: var(--tg-theme-hint-color, #aaaaaa); }
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #444;
            background-color: var(--tg-theme-secondary-bg-color, #333);
            color: var(--tg-theme-text-color, #fff);
            box-sizing: border-box; 
            font-size: 16px;
        }
        .hint { font-size: 12px; color: #888; margin-top: -10px; margin-bottom: 5px; }
        h3 { margin-bottom: 10px; border-bottom: 1px solid #444; padding-bottom: 5px; }
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <div class="container">
        <h3>‚è± –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏</h3>
        
        <label>–ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–∏–Ω—É—Ç)</label>
        <input type="number" id="check_interval" min="1" step="1">
        
        <label>–ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–º–∏ (—Å–µ–∫—É–Ω–¥)</label>
        <input type="number" id="post_interval" min="1" step="1">

        <h3>üì¶ –ü—É–±–ª–∏–∫–∞—Ü–∏—è</h3>
        
        <label>–ü–æ—Å—Ç–æ–≤ –∑–∞ –æ–¥–Ω—É –ø—Ä–æ–≤–µ—Ä–∫—É</label>
        <input type="number" id="posts_per_check" min="1" step="1">
        
        <label>–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–µ–π (—á–∞—Å–æ–≤)</label>
        <input type="number" id="max_age_hours" min="1" step="1">
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" (MainButton) –æ—Ç —Å–∞–º–æ–≥–æ –¢–µ–ª–µ–≥—Ä–∞–º–∞
        tg.MainButton.text = "–°–û–•–†–ê–ù–ò–¢–¨ –ù–ê–°–¢–†–û–ô–ö–ò";
        tg.MainButton.show();

        // 1. –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ URL (–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ü–ö -> –¢–µ–ª–µ—Ñ–æ–Ω)
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                check_interval: params.get('check_interval'),
                post_interval: params.get('post_interval'),
                posts_per_check: params.get('posts_per_check'),
                max_age_hours: params.get('max_age_hours')
            };
        }

        // 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
        const params = getQueryParams();
        if (params.check_interval) document.getElementById('check_interval').value = params.check_interval;
        if (params.post_interval) document.getElementById('post_interval').value = params.post_interval;
        if (params.posts_per_check) document.getElementById('posts_per_check').value = params.posts_per_check;
        if (params.max_age_hours) document.getElementById('max_age_hours').value = params.max_age_hours;

        // 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω–æ –±–æ—Ç—É (–¢–µ–ª–µ—Ñ–æ–Ω -> –ü–ö)
        Telegram.WebApp.onEvent('mainButtonClicked', function(){
            const data = {
                check_interval: parseInt(document.getElementById('check_interval').value),
                post_interval: parseInt(document.getElementById('post_interval').value),
                posts_per_check: parseInt(document.getElementById('posts_per_check').value),
                max_age_hours: parseInt(document.getElementById('max_age_hours').value)
            };
            tg.sendData(JSON.stringify(data)); 
        });
    </script>
</body>
</html>
